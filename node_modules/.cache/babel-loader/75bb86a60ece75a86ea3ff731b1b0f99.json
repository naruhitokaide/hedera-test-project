{"ast":null,"code":"import Timestamp from \"../Timestamp.js\";\nimport TopicMessageChunk from \"./TopicMessageChunk.js\";\nimport Long from \"long\";\n/**\n * @namespace proto\n * @typedef {import(\"@hashgraph/proto\").IConsensusTopicResponse} proto.IConsensusTopicResponse\n * @typedef {import(\"@hashgraph/proto\").ITimestamp} proto.ITimestamp\n */\n\nexport default class TopicMessage {\n  /**\n   * @private\n   * @param {object} props\n   * @param {Timestamp} props.consensusTimestamp\n   * @param {Uint8Array} props.contents\n   * @param {Uint8Array} props.runningHash\n   * @param {Long} props.sequenceNumber\n   * @param {TopicMessageChunk[]} props.chunks\n   */\n  constructor(props) {\n    /** @readonly */\n    this.consensusTimestamp = props.consensusTimestamp;\n    /** @readonly */\n\n    this.contents = props.contents;\n    /** @readonly */\n\n    this.runningHash = props.runningHash;\n    /** @readonly */\n\n    this.sequenceNumber = props.sequenceNumber;\n    /** @readonly */\n\n    this.chunks = props.chunks;\n    Object.freeze(this);\n  }\n  /**\n   * @internal\n   * @param {proto.IConsensusTopicResponse} response\n   * @returns {TopicMessage}\n   */\n\n\n  static _ofSingle(response) {\n    return new TopicMessage({\n      consensusTimestamp: Timestamp._fromProtobuf(\n      /** @type {proto.ITimestamp} */\n      response.consensusTimestamp),\n      contents: response.message != null ? response.message : new Uint8Array(),\n      runningHash: response.runningHash != null ? response.runningHash : new Uint8Array(),\n      sequenceNumber: response.sequenceNumber != null ? response.sequenceNumber instanceof Long ? response.sequenceNumber : Long.fromNumber(response.sequenceNumber) : Long.ZERO,\n      chunks: [TopicMessageChunk._fromProtobuf(response)]\n    });\n  }\n  /**\n   * @internal\n   * @param {proto.IConsensusTopicResponse[]} responses\n   * @returns {TopicMessage}\n   */\n\n\n  static _ofMany(responses) {\n    const length = responses.length;\n    const last =\n    /** @type {proto.IConsensusTopicResponse} */\n    responses[length - 1];\n\n    const consensusTimestamp = Timestamp._fromProtobuf(\n    /** @type {proto.ITimestamp} */\n    last.consensusTimestamp);\n\n    const runningHash =\n    /** @type {Uint8Array} */\n    last.runningHash;\n    /**\n     * @type {Long}\n     */\n\n    const sequenceNumber = last.sequenceNumber != null ? last.sequenceNumber instanceof Long ? last.sequenceNumber : Long.fromValue(last.sequenceNumber) : Long.ZERO;\n    responses.sort((a, b) => (a != null ? a.chunkInfo != null ? a.chunkInfo.number != null ? a.chunkInfo.number : 0 : 0 : 0) < (b != null ? b.chunkInfo != null ? b.chunkInfo.number != null ? b.chunkInfo.number : 0 : 0 : 0) ? -1 : 1);\n    /**\n     * @type {TopicMessageChunk[]}\n     */\n\n    const chunks = responses.map(\n    /**\n     * @type {proto.IConsensusTopicResponse}\n     */\n    m => TopicMessageChunk._fromProtobuf(m));\n    const size = chunks.map(chunk => chunk.contents.length).reduce((sum, current) => sum + current, 0);\n    const contents = new Uint8Array(size);\n    let offset = 0;\n    responses.forEach(value => {\n      contents.set(\n      /** @type {Uint8Array} */\n      value.message, offset);\n      offset +=\n      /** @type {Uint8Array} */\n      value.message.length;\n    });\n    return new TopicMessage({\n      consensusTimestamp,\n      contents,\n      runningHash,\n      sequenceNumber,\n      chunks\n    });\n  }\n\n}","map":{"version":3,"sources":["C:/Work/coding-sandbox/react-again/dapp-days/node_modules/@hashgraph/sdk/src/topic/TopicMessage.js"],"names":["Timestamp","TopicMessageChunk","Long","TopicMessage","constructor","props","consensusTimestamp","contents","runningHash","sequenceNumber","chunks","Object","freeze","_ofSingle","response","_fromProtobuf","message","Uint8Array","fromNumber","ZERO","_ofMany","responses","length","last","fromValue","sort","a","b","chunkInfo","number","map","m","size","chunk","reduce","sum","current","offset","forEach","value","set"],"mappings":"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","sourcesContent":["import Timestamp from \"../Timestamp.js\";\nimport TopicMessageChunk from \"./TopicMessageChunk.js\";\nimport Long from \"long\";\n\n/**\n * @namespace proto\n * @typedef {import(\"@hashgraph/proto\").IConsensusTopicResponse} proto.IConsensusTopicResponse\n * @typedef {import(\"@hashgraph/proto\").ITimestamp} proto.ITimestamp\n */\n\nexport default class TopicMessage {\n    /**\n     * @private\n     * @param {object} props\n     * @param {Timestamp} props.consensusTimestamp\n     * @param {Uint8Array} props.contents\n     * @param {Uint8Array} props.runningHash\n     * @param {Long} props.sequenceNumber\n     * @param {TopicMessageChunk[]} props.chunks\n     */\n    constructor(props) {\n        /** @readonly */\n        this.consensusTimestamp = props.consensusTimestamp;\n        /** @readonly */\n        this.contents = props.contents;\n        /** @readonly */\n        this.runningHash = props.runningHash;\n        /** @readonly */\n        this.sequenceNumber = props.sequenceNumber;\n        /** @readonly */\n        this.chunks = props.chunks;\n\n        Object.freeze(this);\n    }\n\n    /**\n     * @internal\n     * @param {proto.IConsensusTopicResponse} response\n     * @returns {TopicMessage}\n     */\n    static _ofSingle(response) {\n        return new TopicMessage({\n            consensusTimestamp: Timestamp._fromProtobuf(\n                /** @type {proto.ITimestamp} */\n                (response.consensusTimestamp)\n            ),\n            contents:\n                response.message != null ? response.message : new Uint8Array(),\n            runningHash:\n                response.runningHash != null\n                    ? response.runningHash\n                    : new Uint8Array(),\n            sequenceNumber:\n                response.sequenceNumber != null\n                    ? response.sequenceNumber instanceof Long\n                        ? response.sequenceNumber\n                        : Long.fromNumber(response.sequenceNumber)\n                    : Long.ZERO,\n            chunks: [TopicMessageChunk._fromProtobuf(response)],\n        });\n    }\n\n    /**\n     * @internal\n     * @param {proto.IConsensusTopicResponse[]} responses\n     * @returns {TopicMessage}\n     */\n    static _ofMany(responses) {\n        const length = responses.length;\n\n        const last = /** @type {proto.IConsensusTopicResponse} */ (\n            responses[length - 1]\n        );\n\n        const consensusTimestamp = Timestamp._fromProtobuf(\n            /** @type {proto.ITimestamp} */\n            (last.consensusTimestamp)\n        );\n\n        const runningHash = /** @type {Uint8Array} */ (last.runningHash);\n\n        /**\n         * @type {Long}\n         */\n        const sequenceNumber =\n            last.sequenceNumber != null\n                ? last.sequenceNumber instanceof Long\n                    ? last.sequenceNumber\n                    : Long.fromValue(last.sequenceNumber)\n                : Long.ZERO;\n\n        responses.sort((a, b) =>\n            (a != null\n                ? a.chunkInfo != null\n                    ? a.chunkInfo.number != null\n                        ? a.chunkInfo.number\n                        : 0\n                    : 0\n                : 0) <\n            (b != null\n                ? b.chunkInfo != null\n                    ? b.chunkInfo.number != null\n                        ? b.chunkInfo.number\n                        : 0\n                    : 0\n                : 0)\n                ? -1\n                : 1\n        );\n\n        /**\n         * @type {TopicMessageChunk[]}\n         */\n        const chunks = responses.map(\n            /**\n             * @type {proto.IConsensusTopicResponse}\n             */ (m) => TopicMessageChunk._fromProtobuf(m)\n        );\n\n        const size = chunks\n            .map((chunk) => chunk.contents.length)\n            .reduce((sum, current) => sum + current, 0);\n\n        const contents = new Uint8Array(size);\n        let offset = 0;\n\n        responses.forEach((value) => {\n            contents.set(/** @type {Uint8Array} */ (value.message), offset);\n            offset += /** @type {Uint8Array} */ (value.message).length;\n        });\n\n        return new TopicMessage({\n            consensusTimestamp,\n            contents,\n            runningHash,\n            sequenceNumber,\n            chunks,\n        });\n    }\n}\n"]},"metadata":{},"sourceType":"module"}